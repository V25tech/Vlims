<div class="container-fluid">
  <div class="row p-2">
    <div class="col">
      <h4 class="page-title">{{editMode? 'Update': 'Add'}} Existing Document Request</h4>
    </div>
  </div>
  <div class="row p-2">
    <div class="col">
      <form (ngSubmit)="Save()">
        <div class="p-4 bg-white shadow-dark rounded-2">

          <div class="form-group row">
            <label for="documentType" class="col-sm-2 col-form-label">Document Type</label>
            <div class="col-sm-10">
              <input type="text" class="form-control" id="documentType" name="DocumentType" placeholder=""
                [(ngModel)]="existingDocReq.documenttype" [disabled]="viewMode" />
            </div>
          </div>

          <div class="form-group row">
            <label for="documentType" class="col-sm-2 col-form-label">Department</label>
            <div class="col-sm-10">
              <input type="text" class="form-control" id="department" name="Department" placeholder=""
                [(ngModel)]="existingDocReq.department" [disabled]="viewMode" />
            </div>
          </div>

          <div class="form-group row">
            <label for="documentTitle" class="col-sm-2 col-form-label">Document Title</label>
            <div class="col-sm-10">
              <input type="text" class="form-control" id="documentTitle" name="documentTitle"
                placeholder="Document Title" [(ngModel)]="existingDocReq.documenttitle" readonly/>
            </div>
          </div>

          <div class="form-group row">
            <label for="documentType" class="col-sm-2 col-form-label">Document Number</label>
            <div class="col-sm-10">
              <input type="text" class="form-control" id="dnumber" name="Dnumber" placeholder=""
                [(ngModel)]="existingDocReq.documentno" [disabled]="viewMode" />
            </div>
          </div>

          <div class="form-group row">
            <label for="documentType" class="col-sm-2 col-form-label">Effective Date</label>
            <div class="col-sm-10">
              <input type="date" class="form-control" id="edate" name="Edate" placeholder="Enter First Nmae"
                [(ngModel)]="effectiveDate" (change)="changeDate($event)" [disabled]="viewMode" />
            </div>
          </div>

          <div class="form-group row">
            <label for="documentType" class="col-sm-2 col-form-label">Review Date</label>
            <div class="col-sm-10">
              <input type="date" class="form-control" id="rdate" name="Rdate" placeholder="Enter First Nmae"
                [(ngModel)]="existingDocReq.reviewDate" [disabled]="viewMode" />
            </div>
          </div>

          <div class="form-group row">
            <label for="document" class="col-sm-2 col-form-label">Browse Document</label>
            <div *ngIf="!existingDocReq.document" class="col-sm-10">
              <input class="form-control" type="file" id="fileInput" name="fileInput" #fileInput [disabled]="isUploaded"
                (change)="onFileSelected($event)" [disabled]="viewMode">
            </div>
            <div *ngIf="existingDocReq.document" class="col-sm-2">
              <a class="link-opacity-100-hover" (click)="previewtemplate(template)">View Document</a>
            </div>
            <div *ngIf="existingDocReq.document" class="col-sm-8">
              <button type="button" class="btn btn-danger mx-2" (click)="onDeleteFile()" [disabled]="viewMode">Delete</button>
            </div>
          </div>
          <div *ngIf="selectedFile && !isUploaded" class="form-group row">
            <label for="document" class="col-sm-2 col-form-label"></label>
            <div class="col-sm-10">
              <button type="button" class="btn btn-outline-secondary mx-2" (click)="onUpload()">Upload</button>
            </div>
          </div> 

          <div class="form-group row">
            <label for="bdoc" class="col-sm-2 col-form-label">Sample Template</label>
            <div class="col-sm-10">
              <a [href]="fileUploadLink" target="_blank">Upload Excel Sheet</a>
            </div>
          </div>

          <div class="form-group row my-4">
            <div class="col-sm-10 offset-sm-2">
              <button type="button" class="btn btn-outline-secondary mx-2" (click)="onCancel()">Cancel</button>
              <button type="submit" class="btn btn-primary" *ngIf="!editMode">Submit</button>
              <button type="submit" class="btn btn-primary" *ngIf="editMode">Update</button>
            </div>
          </div>
        </div>
      </form>
    </div>
  </div>
</div>

<ng-template #template>
  <div class="modal-header">
    <h4 class="modal-title pull-left">Preview</h4>
    <button type="button" class="close pull-right" aria-label="Close" (click)="closeModel()">
      <span aria-hidden="true">Ã—</span>
    </button>
  </div>
  <div class="modal-body">
    <iframe *ngIf="pdfUrl" [src]="pdfUrl" type="application/pdf" width="100%" height="500px"></iframe>
  </div>
  <div class="modal-footer">
    <button type="button" class="btn btn-default" (click)="closeModel()">Close</button>
  </div>
</ng-template>